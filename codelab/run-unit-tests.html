<!DOCTYPE html><html lang=en data-version=c35baec><head><meta charset=utf-8><title>Step 6: Test with Karma and Jasmine | Yeoman</title><meta name=viewport content="width=device-width"><link rel=icon type=image/x-icon href=/static/favicon.b25e58c4b8.ico><meta name=google-site-verification content=fBQRJ6h7MV7_TJ7grbgq4P-d-07NRfDWPe4pqEEoH5w><link href="////fonts.gmirror.org/css?family=Roboto+Slab:400,700%7CRoboto:400,700,700italic,400italic" rel=stylesheet><link rel=stylesheet href=/static/bundle-5147.e3a9338fec.css><style>em{padding-right:2px}.highlight>pre,code.prettyprint{color:#fff}.social{margin-top:25px}.authors{font-style:italic}.keyboard{border:1px solid #ccc;border-radius:5px;padding:2px 6px;font-style:normal}.note{padding:25px}.note code,.note pre{padding:.2em .4em;border-radius:3px;border-width:0}.note.important{background:#f2dede}.note.important code,.note.important pre{background:#e2cbcb}.note.tip{background:#d2e0d2}.note.tip code,.note.tip pre{background:#bed3be}.note li,.note p{font-size:.9em}.note h2{font-size:1em;margin-top:1em}.note :first-child{margin-top:0}.note :last-child{margin-bottom:0}.mast-holder{width:100%;text-align:center}.mast-holder img{max-height:350px}.mast-intro>img{max-height:300px}@media (min-width:761px){.mast-intro>img{float:left;margin:-10px 10px 0 0;display:block}.mast-intro~h2{clear:left}}@media (min-width:761px){.side-by-side,article{overflow:auto}.side-by-side img{width:50%;float:left}}.codelab-paging{margin-top:2em;text-align:center}.codelab-paging a{font-weight:700;white-space:nowrap}.codelab-paging a:first-child{margin-right:1em}.codelab-paging a:nth-of-type(2){margin-left:1em}

/*# sourceMappingURL=../static/yowebapp-5336.52ec788454.map*/</style><link href=/blog/atom.xml type=application/atom+xml rel=alternate title="Yeoman Blog Atom Feed"></head><body class=codelab><header class=page-header><div class=container><div class=mobile-bar><h1 class=logo><a href=/ ><img src=/static/logo.2a54d87108.png alt=Yeoman></a></h1><button class="mobile-menu-toggle ir">open</button></div><nav class=main-menu><ul class=main-nav><li><a href=/learning/ >使用 Yeoman</a><ul> <li><a href=/learning/index.html>起步</a></li> <li><a href=/codelab/index.html>指引 (codelab)</a></li> <li><a href=/learning/resources.html>资源</a></li> <li><a href=/learning/deployment.html>部署</a></li> <li><a href=/learning/faq.html>FAQ</a></li> <li><a href=/learning/support.html>支持</a></li></ul></li><li><a href=/generators/ >寻找 generators</a></li> <li><a href=/authoring/ >创建一个 generator</a><ul> <li><a href=/authoring/index.html>起步</a></li> <li><a href=/authoring/running-context.html>启动环境</a></li> <li><a href=/authoring/user-interactions.html>用户交互</a></li> <li><a href=/authoring/composability.html>可组合性</a></li> <li><a href=/authoring/dependencies.html>管理依赖</a></li> <li><a href=/authoring/file-system.html>文件系统交互</a></li> <li><a href=/authoring/gruntfile.html>创建 Gruntfile</a></li> <li><a href=/authoring/storage.html>保存用户设置</a></li> <li><a href=/authoring/testing.html>单元测试</a></li> <li><a href=/authoring/debugging.html>Generators 调试</a></li> <li><a href=/authoring/integrating-yeoman.html>整合 yeoman 工具</a></li> <li><a href=http://yeoman.io/generator/ >API 文档</a></li></ul></li><li><a href=/blog/ >博客</a></li> <li><a href=/contributing/ >贡献</a><ul> <li><a href=/contributing/index.html>贡献</a></li> <li><a href=/contributing/opening-issues.html>怎样提问</a></li> <li><a href=/contributing/pull-request.html>怎样提交一个 PR</a></li> <li><a href=/contributing/style-guide.html>书写规范</a></li> <li><a href=/contributing/testing-guidelines.html>测试指南</a></li> <li><a href=/contributing/ticketing.html>常见问题</a></li></ul></li></ul></nav></div></header><div class=SiteWrapper><div id=content><h2 class=page-title><span class=container>Step 6: Test with Karma and Jasmine</span></h2><div class="container clearfix has-sidebar"><nav class=context-nav><ul><li><a href=/codelab/index.html>Let's Scaffold a Web App</a></li> <li><a href=/codelab/setup.html>Step 1</a></li> <li><a href=/codelab/install-generators.html>Step 2</a></li> <li><a href=/codelab/scaffold-app.html>Step 3</a></li> <li><a href=/codelab/review-generated-files.html>Step 4</a></li> <li><a href=/codelab/preview-inbrowser.html>Step 5</a></li> <li><a href=/codelab/run-unit-tests.html class=active>Step 6</a></li> <li><a href=/codelab/local-storage.html>Step 7</a></li> <li><a href=/codelab/prepare-production.html>Step 8</a></li> <li><a href=/codelab/keep-going.html>Keep going</a></li></ul></nav><article class=main><div class=social><a href=https://twitter.com/share class=twitter-share-button data-text="Let's Scaffold A Web App With @Yeoman!" data-url="">Tweet</a><script>!function(a,b,c){var d,e=a.getElementsByTagName(b)[0],f=/^http:/.test(a.location)?'http':'https';a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src=f+'://platform.twitter.com/widgets.js',e.parentNode.insertBefore(d,e))}(document,'script','twitter-wjs')//# sourceMappingURL=../static/yowebapp-5337.a4780b8280.map </script><script src=https://apis.google.com/js/plusone.js></script><g:plus action=share></g:plus></div><section class=content-chunk><p>For those unfamiliar with <a href=http://karma-runner.github.io>Karma</a>, it is a JavaScript test runner that is test framework agnostic. The fountainjs generator has included test framework <a href=http://jasmine.github.io/ >Jasmine</a>. When we ran <code>yo fountain-webapp</code> earlier in this codelab the generator scaffolded files with pattern <code>*.spec.js</code> in the source folder of the <code>mytodo</code> folder, created a <code>conf/karma.conf.js</code> file, and pulled in the Node modules for Karma. We’ll be editing a Jasmine script to describe our tests soon but let’s see how we can run tests first.</p><h2>Run unit tests</h2><p>Let’s go back to the command line and kill our local server using <span class=keyboard>Ctrl</span>+<span class=keyboard>C</span>. There is already a npm script scaffolded out in our <code>package.json</code> for running tests. It can be run as follows:</p><div class=highlight><pre><code class=language-sh data-lang=sh>npm <span class=nb>test</span>
</code></pre></div><p>Every tests should pass.</p><h2>Update unit tests</h2><p>You’ll find unit tests scaffolded in the <code>src</code> folder, so open up <strong>src/app/reducers/todos.spec.js</strong>. This is the unit test for your Todos reducer. For example we get focus on the first test who verify the initial state.</p><div class=highlight><pre><code class=language-js data-lang=js><span class=nx>it</span><span class=p>(</span><span class=s1>'should handle initial state'</span><span class=p>,</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
  <span class=nx>expect</span><span class=p>(</span><span class=nx>todos</span><span class=p>(</span><span class=kc>undefined</span><span class=p>,</span> <span class=p>{})).</span><span class=nx>toEqual</span><span class=p>([</span>
    <span class=p>{</span>
      <span class=nx>text</span><span class=o>:</span> <span class=s1>'Use Redux'</span><span class=p>,</span>
      <span class=nx>completed</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
      <span class=nx>id</span><span class=o>:</span> <span class=mi>0</span>
    <span class=p>}</span>
  <span class=p>]);</span>
<span class=p>});</span>
</code></pre></div><p>And replace that test with the following:</p><div class=highlight><pre><code class=language-js data-lang=js><span class=nx>it</span><span class=p>(</span><span class=s1>'should handle initial state'</span><span class=p>,</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
  <span class=nx>expect</span><span class=p>(</span><span class=nx>todos</span><span class=p>(</span><span class=kc>undefined</span><span class=p>,</span> <span class=p>{})).</span><span class=nx>toEqual</span><span class=p>([</span>
    <span class=p>{</span>
      <span class=nx>text</span><span class=o>:</span> <span class=s1>'Use Yeoman'</span><span class=p>,</span> <span class=c1>// &lt;=== HERE</span>
      <span class=nx>completed</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
      <span class=nx>id</span><span class=o>:</span> <span class=mi>0</span>
    <span class=p>}</span>
  <span class=p>]);</span>
<span class=p>});</span>
</code></pre></div><p>Re-running our tests with <code>npm test</code> should see our tests now failing.</p><div class="note tip"><p>If you want run test automatically on change you can use <code>npm run test:auto</code> instead.</p></div><p>Open <code>src/app/reducers/todos.js</code>.</p><p>Replace the initial state by:</p><div class=highlight><pre><code class=language-js data-lang=js><span class=kr>const</span> <span class=nx>initialState</span> <span class=o>=</span> <span class=p>[</span>
  <span class=p>{</span>
    <span class=nx>text</span><span class=o>:</span> <span class=s1>'Use Yeoman'</span><span class=p>,</span>
    <span class=nx>completed</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
    <span class=nx>id</span><span class=o>:</span> <span class=mi>0</span>
  <span class=p>}</span>
<span class=p>];</span>
</code></pre></div><p>Fantastic, you have fixed the test:</p><p><img src=/static/06_run_test.c2daec5d52.png alt=""></p><p>Writing unit tests make it easier to catch bugs as your app gets bigger and when more developers join your team. The scaffolding feature of Yeoman makes writing unit tests easier so no excuse for not writing your own tests! ;)</p><p class=codelab-paging><a href=#toc>« Return to overview</a> or <a href=local-storage.html>Go to the next step »</a></p></section></article></div></div><footer class=SiteFooter><div class=SiteFooter-donation><div class=Donation><div class=Donation-sticker-clipping><img src=/static/yeoman-character-sticker.51cef7e007.png class=Donation-sticker width=190 height=294 alt=Stickers!></div><div class=Donation-text><a href=https://www.stickermule.com/user/1070704235/stickers>Show your love for <strong>Yeoman</strong>,<br> wear our <strong>sticker</strong>!</a></div></div></div><ul class=SiteFooter-links><li><a href=https://plus.google.com/101063139999404044459/posts class=icon><img src=/static/social-gplus.5223e7bc73.svg class=SiteFooter-icon alt=Google+></a></li> <li><a href=https://twitter.com/yeoman class=icon><img src=/static/social-twitter.c359540fc8.svg class=SiteFooter-icon alt=Twitter></a></li> <li><a href=https://github.com/yeoman/yeoman class=icon><img src=/static/social-github.89959ef390.svg class=SiteFooter-icon alt=Github></a></li> <li><a href=/blog/atom.xml class=icon><img src=/static/social-feed.ad4bea7819.svg class=SiteFooter-icon alt=Feed></a></li> <li class=mobile-ln></li> <li><a href=http://yeoman.io/generator/ class="SiteFooter-button SiteFooter-button--light">API</a></li> <li><a href=https://github.com/yeoman/yeoman.github.io/blob/source/app/codelab/run-unit-tests.md class=SiteFooter-button title="Edit this page on Github to help improve the site">Improve this page</a></li></ul></footer><script src=//cdn.bootcss.com/jquery/2.1.0/jquery.min.js></script><script src=/static/bundle-5206.6c2a99cb84.js async></script><script>!function(a,b,c){'undefined'!=typeof c.module&&c.module.exports?c.module.exports=b():'undefined'!=typeof c.define&&'function'==c.define&&c.define.amd?define(a,b):c[a]=b()}('$script',function(){function a(a,b){for(var c=0,d=a.length;c<d;++c)if(!b(a[c]))return m;return 1}function b(b,c){a(b,function(a){return!c(a)})}function c(f,g,m){function o(a){return a.call?a():i[a]}function p(){if(!--t){i[s]=1,r&&r();for(var c in k)a(c.split('|'),o)&&!b(k[c],o)&&(k[c]=[])}}f=f[n]?f:[f];var q=g&&g.call,r=q?g:m,s=q?f.join(''):g,t=f.length;return setTimeout(function(){b(f,function(a){return l[a]?(s&&(j[s]=1),2==l[a]&&p()):(l[a]=1,s&&(j[s]=1),d(!h.test(a)&&e?e+a+'.js':a,p),void 0)})},0),c}function d(a,b){var c=f.createElement('script'),d=m;c.onload=c.onerror=c[r]=function(){c[p]&&!/^c|loade/.test(c[p])||d||(c.onload=c[r]=null,d=1,l[a]=2,b())},c.async=1,c.src=a,g.insertBefore(c,g.firstChild)}var e,f=document,g=f.getElementsByTagName('head')[0],h=/^https?:\/\//,i={},j={},k={},l={},m=!1,n='push',o='DOMContentLoaded',p='readyState',q='addEventListener',r='onreadystatechange';return!f[p]&&f[q]&&(f[q](o,function s(){f.removeEventListener(o,s,m),f[p]='complete'},m),f[p]='loading'),c.get=d,c.order=function(a,b,d){!function e(f){f=a.shift(),a.length?c(f,e):c(f,b,d)}()},c.path=function(a){e=a},c.ready=function(d,e,f){d=d[n]?d:[d];var g=[];return!b(d,function(a){i[a]||g[n](a)})&&a(d,function(a){return i[a]})?e():!function(a){k[a]=k[a]||[],k[a][n](e),f&&f(g)}(d.join('|')),c},c},this);var _gaq=[['_setAccount','UA-32956520-1'],['_setDomainName','.yeoman.io'],['_trackPageview'],['_trackPageLoadTime']]//# sourceMappingURL=../static/yowebapp-5338.b6a7e77eb7.map </script></div></body></html>